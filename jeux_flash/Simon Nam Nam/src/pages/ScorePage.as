package pages {	import com.gaiaframework.api.*;	import com.gaiaframework.templates.AbstractPage;	import com.greensock.TweenMax;	import flash.display.MovieClip;	import flash.events.Event;	import flash.events.MouseEvent;	import flash.net.URLLoader;	import flash.net.URLRequest;	import flash.net.URLRequestMethod;	import flash.net.URLVariables;	public class ScorePage extends AbstractPage {		public var panneau:MovieClip;		public var btn_rejouer:MovieClip;		private var _urlVariables:URLVariables;		private var _urlLoader:URLLoader;		public function ScorePage() {			super();			alpha = 0;			// new Scaffold(this);		}		override public function transitionIn():void {			super.transitionIn();			TweenMax.to(this, 0.3, {alpha:1, onComplete:transitionInComplete});			panneau.score.text = "";			panneau.nom.text = "";			_urlVariables = new URLVariables();			_urlLoader = new URLLoader();			_urlVariables.project_name = "Beat the bot";			_urlVariables.user_name = Gaia.api.getPage(Pages.INDEX).content.nom;			_urlVariables.max_row = 10;			var urlRequest:URLRequest;			if (Gaia.api.getPage(Pages.INDEX).content.scoreDefini == true) {				_urlVariables.score = Gaia.api.getPage(Pages.INDEX).content.score;				urlRequest = new URLRequest("script/setScore.php");				urlRequest.data = _urlVariables;				urlRequest.method = URLRequestMethod.POST;				_urlLoader.addEventListener(Event.COMPLETE, _donneesEnvoyees);				_urlLoader.load(urlRequest);			} else {				_getHighScore();			}			btn_rejouer.buttonMode = true;			btn_rejouer.addEventListener(MouseEvent.CLICK, _click);			btn_rejouer.addEventListener(MouseEvent.ROLL_OVER, _over);			btn_rejouer.addEventListener(MouseEvent.ROLL_OUT, _out);		}		private function _donneesEnvoyees(evt:Event):void {						_urlLoader.removeEventListener(Event.COMPLETE, _donneesEnvoyees);			_getHighScore();		}		private function _getHighScore():void {			var urlRequest:URLRequest = new URLRequest("script/getTopScores.php");			urlRequest.data = _urlVariables;			urlRequest.method = URLRequestMethod.POST;			_urlLoader.addEventListener(Event.COMPLETE, _donneesRecuperees);			_urlLoader.load(urlRequest);		}		private function _donneesRecuperees(evt:Event):void {			var xml:XML = XML(evt.target.data);			for each (var result in xml.content.item) {				panneau.score.appendText(result.score + "\n");				panneau.nom.appendText(result.user_name + "\n");			}		}		private function _click(mEvt:MouseEvent):void {			Gaia.api.goto(Pages.JEU);			btn_rejouer.removeEventListener(MouseEvent.CLICK, _click);			btn_rejouer.removeEventListener(MouseEvent.ROLL_OVER, _over);			btn_rejouer.removeEventListener(MouseEvent.ROLL_OUT, _out);		}		private function _out(mEvt:MouseEvent):void {			mEvt.currentTarget.gotoAndStop("base");		}		private function _over(mEvt:MouseEvent):void {			mEvt.currentTarget.gotoAndStop("over");		}		override public function transitionOut():void {			super.transitionOut();			TweenMax.to(this, 0.3, {alpha:0, onComplete:transitionOutComplete});		}	}}